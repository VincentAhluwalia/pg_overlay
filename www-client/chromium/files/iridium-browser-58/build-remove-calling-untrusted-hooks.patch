From 5f339e69ea12f4a424bb10dedfe7c894875d03b9 Mon Sep 17 00:00:00 2001
From: Jan Engelhardt <jengelh@inai.de>
Date: Thu, 20 Apr 2017 16:25:49 +0200
Subject: [PATCH 01/60] build: remove calling untrusted hooks

Avoid downloading untrusted executables and wasting time with a
sysroot.
---
 DEPS | 446 -------------------------------------------------------------------
 1 file changed, 446 deletions(-)

diff --git a/DEPS b/DEPS
index f5dbbf4c8768..0e5c09dd6417 100644
--- a/DEPS
+++ b/DEPS
@@ -352,31 +352,6 @@ hooks = [
   {
     'action': [
       'python',
-      'src/build/download_nacl_toolchains.py',
-      '--mode',
-      'nacl_core_sdk',
-      'sync',
-      '--extract'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'nacltools'
-  },
-  {
-    'action': [
-      'python',
-      'src/build/android/play_services/update.py',
-      'download'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'sdkextras'
-  },
-  {
-    'action': [
-      'python',
       'src/build/android/update_deps/update_third_party_deps.py',
       'download',
       '-b',
@@ -662,59 +637,6 @@ hooks = [
   {
     'action': [
       'python',
-      'src/build/linux/sysroot_scripts/install-sysroot.py',
-      '--running-as-hook'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'sysroot'
-  },
-  {
-    'action': [
-      'python',
-      'src/build/vs_toolchain.py',
-      'update'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'win_toolchain'
-  },
-  {
-    'action': [
-      'python',
-      'src/build/mac_toolchain.py'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'mac_toolchain'
-  },
-  {
-    'action': [
-      'python',
-      'src/third_party/binutils/download.py'
-    ],
-    'pattern':
-      'src/third_party/binutils',
-    'name':
-      'binutils'
-  },
-  {
-    'action': [
-      'python',
-      'src/tools/clang/scripts/update.py',
-      '--if-needed'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'clang'
-  },
-  {
-    'action': [
-      'python',
       'src/build/util/lastchange.py',
       '-o',
       'src/build/util/LASTCHANGE'
@@ -757,272 +679,6 @@ hooks = [
   },
   {
     'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=win32',
-      '--no_auth',
-      '--bucket',
-      'chromium-gn',
-      '-s',
-      'src/buildtools/win/gn.exe.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'gn_win'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=darwin',
-      '--no_auth',
-      '--bucket',
-      'chromium-gn',
-      '-s',
-      'src/buildtools/mac/gn.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'gn_mac'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=linux*',
-      '--no_auth',
-      '--bucket',
-      'chromium-gn',
-      '-s',
-      'src/buildtools/linux64/gn.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'gn_linux64'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=win32',
-      '--no_auth',
-      '--bucket',
-      'chromium-clang-format',
-      '-s',
-      'src/buildtools/win/clang-format.exe.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'clang_format_win'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=darwin',
-      '--no_auth',
-      '--bucket',
-      'chromium-clang-format',
-      '-s',
-      'src/buildtools/mac/clang-format.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'clang_format_mac'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=linux*',
-      '--no_auth',
-      '--bucket',
-      'chromium-clang-format',
-      '-s',
-      'src/buildtools/linux64/clang-format.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'clang_format_linux'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=linux*',
-      '--no_auth',
-      '--bucket',
-      'chromium-gvr-static-shim',
-      '-s',
-      'src/third_party/gvr-android-sdk/libgvr_shim_static_arm.a.sha1'
-    ],
-    'pattern':
-      '\\.sha1',
-    'name':
-      'gvr_static_shim_android_arm'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=linux*',
-      '--no_auth',
-      '--bucket',
-      'chromium-gvr-static-shim',
-      '-s',
-      'src/third_party/gvr-android-sdk/libgvr_shim_static_arm64.a.sha1'
-    ],
-    'pattern':
-      '\\.sha1',
-    'name':
-      'gvr_static_shim_android_arm64'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=linux*',
-      '--no_auth',
-      '--bucket',
-      'chromium-gvr-static-shim',
-      '-s',
-      'src/third_party/gvr-android-sdk/common_library.aar.sha1'
-    ],
-    'pattern':
-      '\\.sha1',
-    'name':
-      'gvr_common_aar'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=win32',
-      '--no_auth',
-      '--bucket',
-      'chromium-luci',
-      '-d',
-      'src/tools/luci-go/win64'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'luci-go_win'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=darwin',
-      '--no_auth',
-      '--bucket',
-      'chromium-luci',
-      '-d',
-      'src/tools/luci-go/mac64'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'luci-go_mac'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=linux*',
-      '--no_auth',
-      '--bucket',
-      'chromium-luci',
-      '-d',
-      'src/tools/luci-go/linux64'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'luci-go_linux'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=linux*',
-      '--no_auth',
-      '--bucket',
-      'chromium-eu-strip',
-      '-s',
-      'src/build/linux/bin/eu-strip.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'eu-strip'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=win32',
-      '--no_auth',
-      '--bucket',
-      'chromium-drmemory',
-      '-s',
-      'src/third_party/drmemory/drmemory-windows-sfx.exe.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'drmemory'
-  },
-  {
-    'action': [
-      'python',
-      'src/build/get_syzygy_binaries.py',
-      '--output-dir=src/third_party/syzygy/binaries',
-      '--revision=37f2efe2518802e568d2b620309c0c4a939e52f1',
-      '--overwrite',
-      '--copy-dia-binaries'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'syzygy-binaries'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=win32',
-      '--directory',
-      '--recursive',
-      '--no_auth',
-      '--num_threads=16',
-      '--bucket',
-      'chromium-apache-win32',
-      'src/third_party/apache-win32'
-    ],
-    'pattern':
-      '\\.sha1',
-    'name':
-      'apache_win32'
-  },
-  {
-    'action': [
-      'python',
-      'src/third_party/instrumented_libraries/scripts/download_binaries.py'
-    ],
-    'pattern':
-      '\\.sha1',
-    'name':
-      'instrumented_libraries'
-  },
-  {
-    'action': [
       'python',
       'src/build/android/download_doclava.py'
     ],
@@ -1035,108 +691,6 @@ hooks = [
     'action': [
       'download_from_google_storage',
       '--no_resume',
-      '--no_auth',
-      '-u',
-      '--bucket',
-      'v8-wasm-fuzzer',
-      '-s',
-      'src/v8/test/fuzzer/wasm.tar.gz.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'wasm_fuzzer'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--no_auth',
-      '-u',
-      '--bucket',
-      'v8-wasm-asmjs-fuzzer',
-      '-s',
-      'src/v8/test/fuzzer/wasm_asmjs.tar.gz.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'wasm_asmjs_fuzzer'
-  },
-  {
-    'action': [
-      'python',
-      'src/tools/clang_format_merge_driver/install_git_hook.py'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'clang_format_merge_driver'
-  },
-  {
-    'action': [
-      'python',
-      'src/third_party/WebKit/Source/devtools/scripts/local_node/node.py',
-      '--running-as-hook',
-      '--version'
-    ],
-    'name':
-      'devtools_install_node'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=linux*',
-      '--extract',
-      '--no_auth',
-      '--bucket',
-      'chromium-nodejs/6.9.4',
-      '-s',
-      'src/third_party/node/linux/node-linux-x64.tar.gz.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'node_linux64'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=darwin',
-      '--extract',
-      '--no_auth',
-      '--bucket',
-      'chromium-nodejs/6.9.4',
-      '-s',
-      'src/third_party/node/mac/node-darwin-x64.tar.gz.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'node_mac'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
-      '--platform=win32',
-      '--no_auth',
-      '--bucket',
-      'chromium-nodejs/6.9.4',
-      '-s',
-      'src/third_party/node/win/node.exe.sha1'
-    ],
-    'pattern':
-      '.',
-    'name':
-      'node_win'
-  },
-  {
-    'action': [
-      'download_from_google_storage',
-      '--no_resume',
       '--extract',
       '--no_auth',
       '--bucket',
-- 
2.12.2


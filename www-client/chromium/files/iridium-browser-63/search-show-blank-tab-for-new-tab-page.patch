From 076ba75da3b3435d5bf22f3b16e9b39b44ebf19b Mon Sep 17 00:00:00 2001
From: Joachim Bauch <jojo@struktur.de>
Date: Mon, 6 Jul 2015 17:17:20 +0200
Subject: [PATCH 51/64] search: show blank tab for new tab page

Avoid loading the search page everytime, just show a blank one instead.

References: https://github.com/iridium-browser/iridium-browser/issues/32
---
 chrome/browser/search/search.cc | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/chrome/browser/search/search.cc b/chrome/browser/search/search.cc
index 22e6a75d843b..c643518b9c39 100644
--- a/chrome/browser/search/search.cc
+++ b/chrome/browser/search/search.cc
@@ -157,6 +157,7 @@ bool IsURLAllowedForSupervisedUser(const GURL& url, Profile* profile) {
   return true;
 }
 
+#if 0
 // Returns whether |new_tab_url| can be used as a URL for the New Tab page.
 // NEW_TAB_URL_VALID means a valid URL; other enum values imply an invalid URL.
 NewTabURLState IsValidNewTabURL(Profile* profile, const GURL& new_tab_url) {
@@ -170,6 +171,7 @@ NewTabURLState IsValidNewTabURL(Profile* profile, const GURL& new_tab_url) {
     return NEW_TAB_URL_BLOCKED;
   return NEW_TAB_URL_VALID;
 }
+#endif
 
 bool ShouldShowLocalNewTab(const GURL& url, Profile* profile) {
 #if defined(OS_CHROMEOS)
@@ -198,6 +200,9 @@ struct NewTabURLDetails {
       : url(url), state(state) {}
 
   static NewTabURLDetails ForProfile(Profile* profile) {
+#if 1
+    return NewTabURLDetails(GURL("about:blank"), NEW_TAB_URL_VALID);
+#else
     const GURL local_url(chrome::kChromeSearchLocalNtpUrl);
 
     base::CommandLine* command_line = base::CommandLine::ForCurrentProcess();
@@ -228,6 +233,7 @@ struct NewTabURLDetails {
         // Use the local New Tab otherwise.
         return NewTabURLDetails(local_url, state);
     }
+#endif
   }
 
   GURL url;
-- 
2.15.0


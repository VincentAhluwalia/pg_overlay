From d4d020cc082f77a6582d2f6914c47b54135ef1ce Mon Sep 17 00:00:00 2001
From: Tilmann Meyer <me@atiltedtree.dev>
Date: Fri, 15 Apr 2022 14:08:16 +0200
Subject: [PATCH 03/11] Guard wayland specific code with MOZ_WAYLAND

---
 testing/tools/screenshot/gdk-screenshot.cpp | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/testing/tools/screenshot/gdk-screenshot.cpp b/testing/tools/screenshot/gdk-screenshot.cpp
index dc75e4c9bfebd..f0c24d7389745 100644
--- a/testing/tools/screenshot/gdk-screenshot.cpp
+++ b/testing/tools/screenshot/gdk-screenshot.cpp
@@ -35,7 +35,9 @@
  *  be written to stdout.
  */
 #include <gdk/gdk.h>
-#include <gdk/gdkx.h>
+#ifdef MOZ_WAYLAND
+#  include <gdk/gdkwayland.h>
+#endif
 
 #include <errno.h>
 #include <stdio.h>
@@ -110,9 +112,9 @@ int main(int argc, char** argv) {
 
   GdkPixbuf* screenshot = nullptr;
 
-#if defined(MOZ_ENABLE_DBUS)
+#if defined(MOZ_ENABLE_DBUS) && defined(MOZ_WAYLAND)
   GdkDisplay* display = gdk_display_get_default();
-  if (display && !GDK_IS_X11_DISPLAY(display)) {
+  if (display && GDK_IS_WAYLAND_DISPLAY(display)) {
     screenshot = get_screenshot_dbus();
   }
 #endif
-- 
2.35.1


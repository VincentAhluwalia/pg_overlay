From 46fcba56a02ea7664e400ae6d7562c847807ba8f Mon Sep 17 00:00:00 2001
From: Tilmann Meyer <me@atiltedtree.dev>
Date: Thu, 18 Nov 2021 15:33:13 +0100
Subject: [PATCH 02/23] move keysym2ucs to widget/gtk

---
 widget/{x11 => gtk}/keysym2ucs.c |  0
 widget/{x11 => gtk}/keysym2ucs.h |  0
 widget/gtk/moz.build             |  1 +
 widget/moz.build                 |  3 ---
 widget/x11/moz.build             | 16 ----------------
 5 files changed, 1 insertion(+), 19 deletions(-)
 rename widget/{x11 => gtk}/keysym2ucs.c (100%)
 rename widget/{x11 => gtk}/keysym2ucs.h (100%)
 delete mode 100644 widget/x11/moz.build

diff --git a/widget/x11/keysym2ucs.c b/widget/gtk/keysym2ucs.c
similarity index 100%
rename from widget/x11/keysym2ucs.c
rename to widget/gtk/keysym2ucs.c
diff --git a/widget/x11/keysym2ucs.h b/widget/gtk/keysym2ucs.h
similarity index 100%
rename from widget/x11/keysym2ucs.h
rename to widget/gtk/keysym2ucs.h
diff --git a/widget/gtk/moz.build b/widget/gtk/moz.build
index 06b29cb23c8f6..6c3cc298ef7fa 100644
--- a/widget/gtk/moz.build
+++ b/widget/gtk/moz.build
@@ -42,6 +42,7 @@ UNIFIED_SOURCES += [
     "gtk3drawing.cpp",
     "GtkCompositorWidget.cpp",
     "IMContextWrapper.cpp",
+    "keysym2ucs.c",
     "MozContainer.cpp",
     "MPRISServiceHandler.cpp",
     "NativeKeyBindings.cpp",
diff --git a/widget/moz.build b/widget/moz.build
index 9b89bfb0826e0..56341f1fa213f 100644
--- a/widget/moz.build
+++ b/widget/moz.build
@@ -268,9 +268,6 @@ if CONFIG["MOZ_INSTRUMENT_EVENT_LOOP"]:
 
 EXPORTS.ipc = ["nsGUIEventIPC.h"]
 
-if CONFIG["MOZ_X11"]:
-    DIRS += ["x11"]
-
 if toolkit in ("cocoa", "windows"):
     UNIFIED_SOURCES += [
         "nsBaseClipboard.cpp",
diff --git a/widget/x11/moz.build b/widget/x11/moz.build
deleted file mode 100644
index 81d345c0af6c8..0000000000000
--- a/widget/x11/moz.build
+++ /dev/null
@@ -1,16 +0,0 @@
-# -*- Mode: python; indent-tabs-mode: nil; tab-width: 40 -*-
-# vim: set filetype=python:
-# This Source Code Form is subject to the terms of the Mozilla Public
-# License, v. 2.0. If a copy of the MPL was not distributed with this
-# file, You can obtain one at http://mozilla.org/MPL/2.0/.
-
-with Files("**"):
-    BUG_COMPONENT = ("Core", "Widget: Gtk")
-
-SOURCES += [
-    "keysym2ucs.c",
-]
-
-FINAL_LIBRARY = "xul"
-
-CFLAGS += CONFIG["MOZ_X11_CFLAGS"]
-- 
2.34.1

